<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="Deploy" ToolsVersion="4.0">
  <PropertyGroup>    
    <FrontendOutputFolder>$([System.IO.Path]::GetFullPath('$(DeployFullPath)\..\..\..\..\mobile\Angular'))</FrontendOutputFolder>  
  </PropertyGroup>

  <Target Name="BuildTarget" Inputs="@(AllFrontendObjects)" Outputs="%(AllFrontendObjects.Identity)">    
     <PropertyGroup>
      <FrontEndAppDirNameItem>%(AllFrontendObjects.QualifiedName)</FrontEndAppDirNameItem>
      <FrontEndAppDirName>$(FrontEndAppDirNameItem.Replace(".", "_"))</FrontEndAppDirName>
    </PropertyGroup>

    <Message Text="Preparing '%(AllFrontendObjects.QualifiedName)' Angular Application... " Importance="high"/>    
    <Exec Command="npm install -f" WorkingDirectory="$(FrontendOutputFolder)\$(FrontEndAppDirName)"/>
    
    <Message Text="Building '%(AllFrontendObjects.QualifiedName)' Angular Application... " Importance="high"/>
    <Exec Command="npm run build " WorkingDirectory="$(FrontendOutputFolder)\$(FrontEndAppDirName)"/>
  </Target>


   <Target Name="ValidateBuildTarget">    
    <Error Text="$(DeploymentDescription) failed: Angular 'Base Href' cannot be empty." Condition="$(STATICFRONTEND_BASE_HREF) == ''"/>    
  </Target>  
</Project>